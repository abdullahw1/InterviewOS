// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider   = "postgresql"
  extensions = [pgvector(map: "vector")]
}

model User {
  id           String   @id @default(cuid())
  email        String   @unique
  passwordHash String
  resumeText   String?  @db.Text
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model InterviewSession {
  id            String   @id @default(cuid())
  interviewType String
  question      String?  @db.Text
  transcript    String   @db.Text
  feedback      Json
  overallScore  Float
  createdAt     DateTime @default(now())
}

model ProjectChunk {
  id         String                      @id @default(cuid())
  repoPath   String
  filePath   String
  chunkIndex Int
  content    String                      @db.Text
  embedding  Unsupported("vector(1536)")
  createdAt  DateTime                    @default(now())

  @@index([repoPath])
}

model LeetCodeEntry {
  id             String    @id @default(cuid())
  problemName    String
  problemUrl     String?
  pattern        String
  difficulty     String
  timeSpent      Int
  result         String
  repetitions    Int       @default(0)
  easeFactor     Float     @default(2.5)
  interval       Int       @default(0)
  nextReviewDate DateTime  @default(now())
  lastReviewDate DateTime?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt
}

model JobApplication {
  id           String    @id @default(cuid())
  company      String
  role         String
  stage        String
  url          String?
  notes        String?   @db.Text
  followUpDate DateTime?
  appliedDate  DateTime  @default(now())
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
}

model CostRecord {
  id            String   @id @default(cuid())
  feature       String
  model         String
  inputTokens   Int
  outputTokens  Int
  estimatedCost Float
  createdAt     DateTime @default(now())
}
